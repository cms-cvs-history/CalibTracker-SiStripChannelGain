process ICALIB = {
   #keep the logging output to a nice level
#   include "DQM/SiStripCommon/data/MessageLogger.cfi"
   include "FWCore/MessageLogger/data/MessageLogger.cfi"

#Geometry
include "Geometry/CMSCommonData/data/cmsMTCCGeometryXML.cfi"
# tracker numbering
include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
# tracker geometry
include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

# magnetic field
#include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
include "MagneticField/Engine/data/uniformMagneticField.cfi"

es_module = TrackerRecoGeometryESProducer {}
 
# KFUpdatoerESProducer
include "TrackingTools/KalmanUpdators/data/KFUpdatorESProducer.cfi"
 
# Chi2MeasurementEstimatorESProducer
include "TrackingTools/KalmanUpdators/data/Chi2MeasurementEstimatorESProducer.cfi" 

# KFTrajectoryFitterESProducer
include "TrackingTools/TrackFitters/data/KFTrajectoryFitterESProducer.cfi"

# KFTrajectorySmootherESProducer
include "TrackingTools/TrackFitters/data/KFTrajectorySmootherESProducer.cfi"

# KFFittingSmootherESProducer
include "TrackingTools/TrackFitters/data/KFFittingSmootherESProducer.cfi"

# PropagatorWithMaterialESProducer
include "TrackingTools/MaterialEffects/data/MaterialPropagator.cfi"

# PropagatorWithMaterialESProducer
include "TrackingTools/MaterialEffects/data/OppositeMaterialPropagator.cfi"

# stripCPE
include "RecoLocalTracker/SiStripRecHitConverter/data/StripCPEfromTrackAngle.cfi"

# pixelCPE
include "RecoLocalTracker/SiPixelRecHits/data/PixelCPEParmError.cfi"

#TransientTrackingBuilder
include "RecoTracker/TransientTrackingRecHit/data/TransientTrackingRecHitBuilder.cfi"

   # Cabling
   es_source FedCablingFromExampleSqliteFile = PoolDBESSource {
                   VPSet toGet            = { { string record = "SiStripFedCablingRcd" string tag = "test" } }
                  string connect          = "sqlite_file:SiStripFedCabling.db"
        #
                  string timetype         = "endoftime"
        untracked uint32 messagelevel     = 0
   }
  # produce SiStripFecCabling and SiStripDetCabling out of SiStripFedCabling
  es_module sistripconn = SiStripConnectivity {}

#===============================================================================
  # input source
# files with possible problems
#"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2552_reco_full.root",
#"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2647_reco_full.root",
#"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2649_reco_full.root",
#"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2654_reco_full.root",
#"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2658_reco_full.root",
#"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2659_reco_full.root",
#"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2660_reco_full.root",
#"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2661_reco_full.root"
  source = PoolSource { 
      untracked vstring fileNames = {
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2476_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2478_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2479_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2480_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2501_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2502_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2503_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2505_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2506_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2507_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2515_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2516_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2517_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2518_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2523_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2524_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2525_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2526_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2527_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2529_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2530_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2531_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2532_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2534_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2544_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2545_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2546_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2547_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2548_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2549_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2550_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2555_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2556_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2557_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2559_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2560_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2561_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2564_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2565_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2567_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2568_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2569_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2570_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2571_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2577_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2578_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2579_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2580_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2581_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2583_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2584_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2587_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2589_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2590_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2591_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2593_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2594_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2596_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2599_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2600_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2602_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2603_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2605_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2610_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2613_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2614_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2615_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2616_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2617_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2618_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2621_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2622_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2623_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2624_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2625_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2626_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2631_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2632_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2636_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2637_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2638_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2639_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2640_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2641_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2642_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2643_reco_full.root",
"file:/nfs/cms/mass7/d/dorian/MTCC/tracker_reprocessing/pass2/2645_reco_full.root"
      }
      untracked int32 maxEvents = -1
//      untracked uint32 skipEvents = 5800
  }

  # analyzer
  module siStripInternalChargeCalibration = SiStripApvGainCalculator {
     bool OutputHistogramsInRootFile = true
     string OutputFileName = "output_histograms.root"
     string TrackProducer  = "cosmictrackfinder"
     string TrackLabel     = ""
     bool   MTCCtrack      = true
     string TTRHBuilder="WithTrackAngle"
     # detector modules to be excluded
     vuint32 detModulesToBeExcluded = {369214217, 369214218 }
     # quality of fit that determines peak of Landau
     untracked uint32 minNrEntries = 60
     untracked double maxChi2OverNDF = 2
  }

//  module AsciiOutputModule = AsciiOutputModule {}

  # schedule
  path p = { siStripInternalChargeCalibration }
//  endpath ep = {AsciiOutputModule}
#===============================================================================
}

